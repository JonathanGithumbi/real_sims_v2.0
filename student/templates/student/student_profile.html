{% extends 'dashboard/layout.html' %}
{% load static %}
{% block content_area %}
    {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <div class="alert {{ message.tags }} alert-dismissible">
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    {{ message }}
                </div>
            {% endfor %}
        </ul>
    {% endif %}
<hr>
<h3>Student Profile</h3>
<hr>
<table class="table table-bordered table-hover">
    <tr>
        <th>Admission Number</th>
        <td>{{student.admission_number_formatted}} </td>
    </tr>
    <tr>
        <th>Name</th>
        <td>{{student.first_name}} {{student.middle_name}} {{student.last_name}} </td>
    </tr>
    <tr>
        <th>Grade</th>
        <td>{{student.current_grade}} </td>
    </tr>
    <tr>
        <th>Primary Contact Name</th>
        <td>{{student.primary_contact_name}} </td>
    </tr>
    <tr>
        <th>Primary Contact Phone Number</th>
        <td>{{student.primary_contact_phone_number}} </td>
    </tr>
    <tr>
        <th>Secondary Contact Name</th>
        <td>{{student.secondary_contact_name}} </td>
    </tr>
    <tr>
        <th>Secondary Contact Phone Number</th>
        <td>{{student.secondary_contact_phone_number}} </td>
    </tr>
    <tr>
        <th>Taking Lunch</th>
        <td>{{student.lunch}} </td>
    </tr>
    <tr>
        <th>Taking Transport</th>
        <td>{{student.transport}} </td>
    </tr>
    
</table>
<a href="{%url 'edit_student_profile' student.id%} "class='btn btn-primary'>Edit Profile</a>
<a href="{%url 'delete_student' student.id%} "class='btn btn-danger'>Delete Student</a>

<hr>
<h3>Payments</h3>
<hr>
<table id="all_payments" class="display table table-bordered table-hover">
    <thead class="thead-light">
        <tr>
            <th>Date Paid</th>
            <th>For Invoice</th>
            <th>Amount</th>
        </tr>
    </thead>
    <tbody>
        {% for payment in payments %}
        <tr>
            <td>{{payment.date_paid}}</td>
            <td>{{payment.invoice.invoice_number_formatted}}</td>
            <td>{{payment.amount}}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<a href="{% url 'create_payment' student.id %}" class='btn btn-primary'>New Payment </a>
<hr>
<h3>Invoices</h3>
<hr>
<table id="all_invoices" class="display table table-bordered table-hover">
    <thead class="thead-light">
        <tr>
            <th>Year</th>
            <th>Term</th>
            <th>Total Amount</th>
            <th>Paid</th>
            <th>Balance</th>
            <th>Details</th>
        </tr>
    </thead>
    <tbody>
        {% for invoice in invoices %}
        <tr>

            <td>{{invoice.year}}</td>
            <td>{{invoice.term}}</td>
            <td>{{invoice.amount}}</td>
            <td>{{invoice.get_amount_paid}}</td>
            <td>{{invoice.balance}}</td>


            <td><a class="btn btn-primary" href="{%url 'invoice_detail' invoice.id%}">Details</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<script>
    $(document).ready( function () {
        $('#all_payments').DataTable();
    } );
    $(document).ready( function () {
        $('#all_invoices').DataTable();
    } );
</script>
{% endblock content_area %}