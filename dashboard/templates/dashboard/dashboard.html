{% extends './layout.html' %}
{% load static %}


{% block content_area %}
QuickBooks Connection Status: 
{% if request.session.qb_synced is True %}<span class="badge bg-success">Connected</span>{% endif %}
{% if request.session.qb_synced is False %}<span class="badge bg-warning">Not Connected</span>{% endif %}
<div>
    {% if openid %}
        <button onclick="userInfoCall()">UserInfo API Call</button>
    {% else %}
        <button onclick="apiCall()">QuickBooks API Call</button>
    {% endif %}
    <button onclick="refreshCall()">Refresh Token Call</button>
    <button onclick="revokeCall()">Revoke Token Call</button>
    
    <br><br>
    <div><code id="result"></code></div>
</div>



 <script>
    function apiCall() {
        $("#result").html('Loading...')
        $.get("/user_account/qbo_request", function (data) {
            $("#result").html(data)
        })
    }

    function revokeCall() {
        $("#result").html('Loading...')
        $.get("/user_account/revoke", function (data) {
            $("#result").html(data)
        })
    }

    function refreshCall() {
        $("#result").html('Loading...')
        $.get("/user_account/refresh", function (data) {
            $("#result").html(JSON.stringify(data, null, 2))
        })
    }

    function userInfoCall() {
        $("#result").html('Loading...')
        $.get("/user_account/user_info", function (data) {
            $("#result").html(data)
        })
    }
</script>
{% endblock content_area %}