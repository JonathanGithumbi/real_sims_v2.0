{% extends 'dashboard/layout.html' %}
{% load static %}

{% block content_area %}

        
        <h3>Connected!</h3>
        <p>Would you like to make a sample API call?</p>
        <div>
            {% if openid %}
                <button onclick="userInfoCall()">UserInfo API Call</button>
            {% else %}
                <button onclick="apiCall()">QuickBooks API Call</button>
            {% endif %}
            <button onclick="refreshCall()">Refresh Token Call</button>
            <button onclick="revokeCall()">Revoke Token Call</button>
            
            <br><br>
            <div><code id="result"></code></div>
        </div>
<script>
    if (window.opener) {
        window.opener.location.href = '/dashboard/connected/'
        window.close()
    }
</script>
<script>
    function apiCall() {
        $("#result").html('Loading...')
        $.get("/user_account/qbo_request", function (data) {
            $("#result").html(data)
        })
    }

    function revokeCall() {
        $("#result").html('Loading...')
        $.get("/user_account/revoke", function (data) {
            $("#result").html(data)
        })
    }

    function refreshCall() {
        $("#result").html('Loading...')
        $.get("/user_account/refresh", function (data) {
            $("#result").html(JSON.stringify(data, null, 2))
        })
    }

    function userInfoCall() {
        $("#result").html('Loading...')
        $.get("/user_account/user_info", function (data) {
            $("#result").html(data)
        })
    }
</script>

{% endblock content_area %}